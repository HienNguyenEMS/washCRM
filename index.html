
<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WebApp Quản lý Xưởng Giặt - Bình Mai</title>

    <!-- Libraries -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Be+Vietnam+Pro:wght@400;500;600;700&display=swap" rel="stylesheet">

    <!-- Custom CSS -->
    <style>
        :root {
            --sidebar-width: 260px;
            --sidebar-collapsed-width: 90px;
            --header-height: 70px;
            --bs-primary-rgb: 13, 110, 253;
            --bs-body-font-family: 'Be Vietnam Pro', sans-serif;
            --bs-body-bg: #f8f9fc;
        }

        /* --- Base Layout --- */
        .wrapper { display: flex; width: 100%; align-items: stretch; }
        #content { width: 100%; min-height: 100vh; transition: margin-left 0.3s ease-in-out; }

        /* --- Sidebar General Styles --- */
        #sidebar { display: flex; flex-direction: column; background: #212529; color: #fff; transition: all 0.3s ease-in-out; z-index: 1040; }
        #sidebar .sidebar-header { height: var(--header-height); display: flex; align-items: center; justify-content: flex-start; gap: 15px; padding: 0 15px; background: #000; flex-shrink: 0; }
        #sidebar .logo-container { text-decoration: none; color: white; display: flex; align-items: center; overflow: hidden; }
        #sidebar .logo { height: 40px; flex-shrink: 0; }
        #sidebar .logo-text { margin-left: 10px; font-weight: 700; font-size: 1.5rem; white-space: nowrap; transition: opacity 0.2s, width 0.2s, margin-left 0.2s; }
        #sidebar .components { padding: 15px 0; flex-grow: 1; overflow-y: auto; }
        #sidebar .components a { padding: 12px 20px; font-size: 0.95rem; display: flex; align-items: center; color: #adb5bd; border-left: 4px solid transparent; text-decoration: none; transition: all 0.2s ease; white-space: nowrap; }
        #sidebar .components a:hover { color: #fff; background: #343a40; }
        #sidebar .components li.active > a { color: #fff; font-weight: 600; background: #0d6efd; border-left-color: #f8f9fa; }
        #sidebar .fa-fw { font-size: 1.1rem; width: 30px; text-align: center; }
        #sidebar a[data-bs-toggle="collapse"] .collapse-icon { margin-left: auto; transition: transform 0.3s ease; font-size: 0.8rem; }
        #sidebar a[data-bs-toggle="collapse"][aria-expanded="true"] .collapse-icon { transform: rotate(-180deg); }
        #sidebar .collapse a { padding-left: calc(20px + 30px); font-size: 0.9rem; background: rgba(0,0,0,0.2); }

        /* --- Header & Main Content --- */
        .main-header { height: var(--header-height); display: flex; align-items: center; justify-content: space-between; padding: 0 1rem; background-color: #fff; border-bottom: 1px solid #e3e6f0; position: sticky; top: 0; z-index: 1020; }
        .main-content.active { animation: fadeIn 0.5s; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .card { box-shadow: 0 0.15rem 1.75rem 0 rgba(58, 59, 69, 0.1); border: 1px solid #e3e6f0; }
        .card-header { font-weight: 600; color: var(--bs-primary); }
        .table-responsive { overflow-x: auto; }

        /* --- MOBILE-FIRST: Off-Canvas Sidebar & Responsive Tabs --- */
        #sidebar { position: fixed; top: 0; left: 0; height: 100vh; width: var(--sidebar-width); transform: translateX(-100%); }
        #sidebar.show { transform: translateX(0); }
        #sidebar-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.5); z-index: 1039; display: none; }
        #sidebar-overlay.active { display: block; }
        #content { margin-left: 0; }

        .nav-tabs-responsive { display: flex; flex-wrap: nowrap; overflow-x: auto; -webkit-overflow-scrolling: touch; }
        .nav-tabs-responsive .nav-link { white-space: nowrap; }

        /* --- DESKTOP-UP: Pinned & Collapsible Sidebar --- */
        @media (min-width: 992px) {
            #sidebar { position: fixed; transform: translateX(0); }
            #sidebar-overlay { display: none !important; }
            #content { margin-left: var(--sidebar-width); }
            
            body.sidebar-collapsed #content { margin-left: var(--sidebar-collapsed-width); }
            body.sidebar-collapsed #sidebar { width: var(--sidebar-collapsed-width); }
            body.sidebar-collapsed #sidebar .logo-text,
            body.sidebar-collapsed #sidebar .nav-link span,
            body.sidebar-collapsed #sidebar .collapse-icon { opacity: 0; width: 0; height: 0; overflow: hidden; margin-left: 0;}
            body.sidebar-collapsed #sidebar .nav-link { justify-content: center; }
            body.sidebar-collapsed #sidebar .fa-fw { margin-right: 0 !important; font-size: 1.5rem; }
            body.sidebar-collapsed #sidebar .collapse.show { display: none; }
        }

        .kanban-container { display: flex; gap: 1rem; overflow-x: auto; padding-bottom: 1rem; scroll-snap-type: x mandatory; }
        .kanban-column { flex: 0 0 320px; scroll-snap-align: start; background-color: #f1f2f6; border-radius: 0.5rem; padding: 0.75rem; }
        .kanban-card .card-footer { background-color: transparent; border-top: 1px solid #e3e6f0; }
        .thumb-image { width: 50px; height: 50px; object-fit: cover; }
    </style>
</head>
<body>

<div id="sidebar-overlay"></div>
<div class="wrapper">
    <nav id="sidebar">
        <div class="sidebar-header">
            <button class="btn btn-dark d-none d-lg-block" type="button" id="desktop-sidebar-toggle-btn"><i class="fas fa-bars"></i></button>
            <a href="#" class="logo-container nav-link" data-view="dashboard">
                <img src="https://gpems.net/_next/image?url=%2Flogo-ico.png&w=64&q=75" alt="Logo" class="logo">
                <span class="logo-text">Wash ERP</span>
            </a>
        </div>
        <ul class="list-unstyled components">
            <li class="active"><a href="#" class="nav-link" data-view="dashboard"><i class="fas fa-tachometer-alt fa-fw"></i><span>Tổng quan</span></a></li>
            <li><a href="#" class="nav-link" data-view="orders"><i class="fas fa-file-invoice-dollar fa-fw"></i><span>Đơn hàng</span></a></li>
            <li><a href="#" class="nav-link" data-view="products"><i class="fas fa-tshirt fa-fw"></i><span>Sản phẩm</span></a></li>
            <li><a href="#" class="nav-link" data-view="production"><i class="fas fa-industry fa-fw"></i><span>Sản xuất</span></a></li>
            <li><a href="#" class="nav-link" data-view="delivery"><i class="fas fa-truck fa-fw"></i><span>Giao hàng</span></a></li>
            <li>
                <a href="#financeSubmenu" data-bs-toggle="collapse" class="nav-link">
                    <i class="fas fa-wallet fa-fw"></i><span>Tài chính</span>
                    <i class="fas fa-chevron-down collapse-icon"></i>
                </a>
                <ul class="collapse list-unstyled" id="financeSubmenu">
                    <li><a href="#" class="nav-link" data-view="finance"><span>Thu - Chi</span></a></li>
                    <li><a href="#" class="nav-link" data-view="accounts"><span>Tài khoản</span></a></li>
                </ul>
            </li>
             <li>
                <a href="#hrSubmenu" data-bs-toggle="collapse" class="nav-link">
                    <i class="fas fa-users fa-fw"></i><span>Nhân sự</span>
                    <i class="fas fa-chevron-down collapse-icon"></i>
                </a>
                <ul class="collapse list-unstyled" id="hrSubmenu">
                    <li><a href="#" class="nav-link" data-view="payroll"><span>Bảng lương</span></a></li>
                    <li><a href="#" class="nav-link" data-view="attendance"><span>Chấm công</span></a></li>
                    <li><a href="#" class="nav-link" data-view="leave"><span>Nghỉ phép</span></a></li>
                    <li><a href="#" class="nav-link" data-view="kpis"><span>KPIs</span></a></li>
                </ul>
            </li>
            <hr class="mx-3 bg-secondary">
             <li><a href="#" class="nav-link" data-view="workflows"><i class="fas fa-project-diagram fa-fw"></i><span>Quy trình</span></a></li>
             <li><a href="#" class="nav-link" data-view="user-guide"><i class="fas fa-book-open fa-fw"></i><span>Hướng dẫn</span></a></li>
            <li>
                <a href="#settingsSubmenu" data-bs-toggle="collapse" class="nav-link">
                    <i class="fas fa-cogs fa-fw"></i><span>Cài đặt</span>
                    <i class="fas fa-chevron-down collapse-icon"></i>
                </a>
                <ul class="collapse list-unstyled" id="settingsSubmenu">
                    <li><a href="#" class="nav-link" data-view="master-data"><span>Dữ liệu nguồn</span></a></li>
                    <li><a href="#" class="nav-link" data-view="users"><span>Người dùng</span></a></li>
                    <li><a href="#" class="nav-link" data-view="roles"><span>Phân quyền</span></a></li>
                </ul>
            </li>
        </ul>
    </nav>

    <div id="content">
        <header class="main-header">
            <div class="d-flex align-items-center gap-2">
                 <button class="btn border-0 d-lg-none" type="button" id="mobile-sidebar-toggle-btn"><i class="fas fa-bars fs-4"></i></button>
                 <div class="input-group" style="max-width: 400px;">
                    <span class="input-group-text bg-light border-0"><i class="fas fa-search"></i></span>
                    <input type="text" class="form-control bg-light border-0" id="global-search-input" placeholder="Tìm kiếm...">
                </div>
                <button class="btn btn-outline-secondary flex-shrink-0">
                    <i class="fas fa-filter"></i>
                    <span class="d-none d-md-inline ms-2">Lọc nâng cao</span>
                </button>
            </div>
            <div class="ms-auto d-flex align-items-center">
                 <div class="dropdown">
                    <a class="nav-link" href="#" role="button" data-bs-toggle="dropdown"><i class="fas fa-bell fa-fw fs-4 text-secondary"></i><span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger">3<span class="visually-hidden">unread</span></span></a>
                    <ul class="dropdown-menu dropdown-menu-end shadow border-0" style="width: 350px;">
                        <li class="dropdown-header">Thông báo</li>
                        <li><a class="dropdown-item d-flex align-items-center" href="#"><div class="me-3"><div class="bg-primary text-white rounded-circle d-flex align-items-center justify-content-center" style="width: 40px; height: 40px;"><i class="fas fa-file-alt"></i></div></div><div><div class="small text-muted">10/07/2024</div><span class="fw-bold">Đơn hàng DH-07019 sắp trễ hẹn!</span></div></a></li>
                        <li><hr class="dropdown-divider"></li>
                        <li><a class="dropdown-item text-center small text-muted" href="#">Xem tất cả</a></li>
                    </ul>
                </div>
                <div class="dropdown ms-3">
                    <a class="nav-link dropdown-toggle d-flex align-items-center" href="#" role="button" data-bs-toggle="dropdown">
                        <img src="https://i.pravatar.cc/40?u=binhmai" alt="Avatar" width="40" height="40" class="rounded-circle me-2">
                        <div><strong class="d-block">Binh Mai</strong><small class="text-muted">Admin</small></div>
                    </a>
                    <ul class="dropdown-menu dropdown-menu-end shadow border-0">
                        <li><a class="dropdown-item nav-link-profile" data-view="my-profile" href="#"><i class="fas fa-user-circle fa-fw me-2"></i>Thông tin cá nhân</a></li>
                        <li><hr class="dropdown-divider"></li>
                        <li><a class="dropdown-item" href="#"><i class="fas fa-sign-out-alt fa-fw me-2"></i>Đăng xuất</a></li>
                    </ul>
                </div>
            </div>
        </header>
        <main id="main-content-area" class="p-3 p-lg-4"></main>
    </div>
</div>

<!-- ALL MODALS -->
<!-- Order Modal (Multi-line) -->
<div class="modal fade" id="order-modal" tabindex="-1" aria-labelledby="orderModalLabel" aria-hidden="true"><div class="modal-dialog modal-xl modal-dialog-centered"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="orderModalLabel">Tạo/Cập nhật Đơn hàng</h5><button type="button" class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><form id="order-form"><h6 class="text-primary">Thông tin chung</h6><hr class="mt-1"><div class="row g-3"><div class="col-md-4"><label class="form-label">Khách hàng</label><select class="form-select"><option selected>Chọn khách hàng...</option><option>An Phước</option><option>Blue Exchange</option></select></div><div class="col-md-4"><label class="form-label">Ngày nhận</label><input type="date" class="form-control" value="2025-07-04"></div><div class="col-md-4"><label class="form-label">Hạn giao hàng</label><input type="date" class="form-control" value="2025-07-15"></div></div><h6 class="text-primary mt-4">Chi tiết Sản phẩm</h6><hr class="mt-1"><div class="table-responsive"><table class="table table-sm table-bordered"><thead><tr><th>Sản phẩm</th><th style="width:120px">Số lượng</th><th style="width:150px">Đơn giá</th><th style="width:180px">Thành tiền</th><th style="width:50px"></th></tr></thead><tbody><tr><td><select class="form-select form-select-sm"><option>QJ-AP-01 - Quần Jean Nam</option><option>SM-AP-02 - Áo Sơ Mi</option></select></td><td><input type="number" class="form-control form-control-sm" value="500"></td><td><input type="number" class="form-control form-control-sm" value="35000"></td><td><input type="text" class="form-control form-control-sm" value="17,500,000" readonly></td><td class="text-center"><button type="button" class="btn btn-sm btn-outline-danger"><i class="fas fa-trash"></i></button></td></tr><tr><td><select class="form-select form-select-sm"><option>QJ-AP-01 - Quần Jean Nam</option><option selected>SM-AP-02 - Áo Sơ Mi</option></select></td><td><input type="number" class="form-control form-control-sm" value="200"></td><td><input type="number" class="form-control form-control-sm" value="25000"></td><td><input type="text" class="form-control form-control-sm" value="5,000,000" readonly></td><td class="text-center"><button type="button" class="btn btn-sm btn-outline-danger"><i class="fas fa-trash"></i></button></td></tr></tbody></table></div><button type="button" class="btn btn-sm btn-outline-primary"><i class="fas fa-plus me-1"></i>Thêm SP</button></form></div><div class="modal-footer"><button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Đóng</button><button type="button" class="btn btn-primary"><i class="fas fa-save me-2"></i>Lưu</button></div></div></div></div>
<!-- Product Modal -->
<div class="modal fade" id="product-modal" tabindex="-1" aria-labelledby="productModalLabel" aria-hidden="true"><div class="modal-dialog modal-lg modal-dialog-centered"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="productModalLabel">Thêm/Sửa</h5><button type="button" class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><form><div class="row g-3"><div class="col-md-6"><label class="form-label">Mã sản phẩm</label><input type="text" class="form-control"></div><div class="col-md-6"><label class="form-label">Tên sản phẩm</label><input type="text" class="form-control"></div><div class="col-md-6"><label class="form-label">Khách hàng</label><select class="form-select"><option>An Phước</option><option>Blue Exchange</option><option>Canifa</option><option>Owen</option></select></div><div class="col-md-6"><label class="form-label">Đơn giá</label><input type="number" class="form-control"></div><div class="col-12"><label class="form-label">Mô tả</label><textarea class="form-control" rows="3"></textarea></div></div></form></div><div class="modal-footer"><button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Đóng</button><button type="button" class="btn btn-primary">Lưu</button></div></div></div></div>
<!-- Production Scan Modal -->
<div class="modal fade" id="scan-modal" tabindex="-1" aria-labelledby="scanModalLabel" aria-hidden="true"><div class="modal-dialog modal-lg modal-dialog-centered"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="scanModalLabel"><i class="fas fa-barcode me-2"></i>Ghi Nhật Ký Sản Xuất</h5><button type="button" class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="row g-4"><div class="col-md-5"><h6>Camera Scan</h6><div id="scan-camera-feed" class="d-flex align-items-center justify-content-center text-muted bg-dark border border-secondary rounded" style="min-height: 200px;"><i>Camera feed</i></div><div class="d-grid mt-2"><button class="btn btn-outline-primary"><i class="fas fa-camera me-2"></i>Bắt đầu quét</button></div></div><div class="col-md-7"><h6>Thông tin Cập nhật</h6><div class="mb-3"><label class="form-label">Mã Lô/Đơn hàng</label><input type="text" class="form-control" value="LÔ-0708-AP01" readonly></div><div class="mb-3"><label class="form-label">Công đoạn</label><select class="form-select"><option>Giặt/Nhuộm</option><option>Wash/Ủi</option></select></div><div class="row g-3"><div class="col-sm-6"><label class="form-label">Số lượng thực tế</label><input type="number" class="form-control"></div><div class="col-sm-6"><label class="form-label">Số lượng hư</label><input type="number" class="form-control text-danger"></div></div><div class="mt-3"><label class="form-label">Người thực hiện</label><input type="text" class="form-control" value="Binh Mai" readonly></div></div></div></div><div class="modal-footer"><button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Hủy</button><button type="button" class="btn btn-success"><i class="fas fa-check me-2"></i>Lưu Nhật Ký</button></div></div></div></div>
<!-- Delivery Modal (Multi-line) -->
<div class="modal fade" id="delivery-modal" tabindex="-1" aria-labelledby="deliveryModalLabel" aria-hidden="true"><div class="modal-dialog modal-xl modal-dialog-centered"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="deliveryModalLabel">Tạo Phiếu</h5><button type="button" class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><form><h6 class="text-primary">Thông tin chung</h6><hr class="mt-1"><div class="row g-3"><div class="col-md-4"><label class="form-label">Khách hàng</label><input type="text" class="form-control" value="An Phước" readonly></div><div class="col-md-4"><label class="form-label">Người giao</label><input type="text" class="form-control"></div><div class="col-md-4"><label class="form-label">Ngày giao</label><input type="date" class="form-control"></div><div class="col-12"><label class="form-label">Địa chỉ giao</label><input type="text" class="form-control" value="KCN Tân Bình, TP.HCM" readonly></div></div><h6 class="text-primary mt-4">Chi tiết hàng hóa giao</h6><hr class="mt-1"><div class="table-responsive"><table class="table table-sm table-bordered"><thead><tr><th>Mã Lô SX</th><th>Sản phẩm</th><th style="width:120px">Số lượng</th></tr></thead><tbody><tr><td><select class="form-select form-select-sm"><option selected>LÔ-0708-AP01</option><option>LÔ-0708-AP02</option></select></td><td>Quần Jean QJ-AP-01</td><td><input type="number" class="form-control form-control-sm" value="500"></td></tr><tr><td><select class="form-select form-select-sm"><option>LÔ-0708-AP01</option><option selected>LÔ-0708-AP02</option></select></td><td>Áo Sơ Mi SM-AP-02</td><td><input type="number" class="form-control form-control-sm" value="200"></td></tr></tbody></table></div><button type="button" class="btn btn-sm btn-outline-primary"><i class="fas fa-plus me-1"></i>Thêm dòng</button></form></div><div class="modal-footer"><button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Hủy</button><button type="button" class="btn btn-primary"><i class="fas fa-shipping-fast me-2"></i>Xác nhận Giao hàng</button></div></div></div></div>
<!-- Customer Modal -->
<div class="modal fade" id="customer-modal" tabindex="-1" aria-labelledby="customerModalLabel" aria-hidden="true"><div class="modal-dialog modal-lg modal-dialog-centered"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="customerModalLabel">Thêm/Sửa</h5><button type="button" class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><form><div class="row g-3"><div class="col-md-6"><label class="form-label">Mã khách hàng</label><input type="text" class="form-control" placeholder="Hệ thống tự tạo..."></div><div class="col-md-6"><label class="form-label">Tên công ty</label><input type="text" class="form-control"></div><div class="col-md-6"><label class="form-label">Mã số thuế</label><input type="text" class="form-control"></div><div class="col-md-6"><label class="form-label">Người liên hệ</label><input type="text" class="form-control"></div><div class="col-md-6"><label class="form-label">Số điện thoại</label><input type="text" class="form-control"></div><div class="col-md-6"><label class="form-label">Email</label><input type="email" class="form-control"></div><div class="col-12"><label class="form-label">Địa chỉ</label><input type="text" class="form-control"></div></div></form></div><div class="modal-footer"><button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Đóng</button><button type="button" class="btn btn-primary">Lưu</button></div></div></div></div>
<!-- User Modal -->
<div class="modal fade" id="user-modal" tabindex="-1" aria-labelledby="userModalLabel" aria-hidden="true"><div class="modal-dialog modal-lg modal-dialog-centered"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="userModalLabel">Thêm/Sửa</h5><button type="button" class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><form><div class="row g-3"><div class="col-md-6"><label class="form-label">Tên hiển thị</label><input type="text" class="form-control"></div><div class="col-md-6"><label class="form-label">Tên đăng nhập</label><input type="text" class="form-control"></div><div class="col-md-6"><label class="form-label">Email</label><input type="email" class="form-control"></div><div class="col-md-6"><label class="form-label">Số điện thoại</label><input type="text" class="form-control"></div><div class="col-md-6"><label class="form-label">Phòng ban</label><input type="text" class="form-control"></div><div class="col-md-6"><label class="form-label">Chức vụ</label><input type="text" class="form-control"></div><div class="col-md-6"><label class="form-label">Vai trò</label><select class="form-select"><option>Admin</option><option>Quản lý</option><option>Nhân viên</option></select></div><div class="col-md-6"><label class="form-label">Trạng thái</label><select class="form-select"><option value="1">Hoạt động</option><option value="0">Khóa</option></select></div></div></form></div><div class="modal-footer"><button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Đóng</button><button type="button" class="btn btn-primary">Lưu</button></div></div></div></div>
<!-- Finance Modal -->
<div class="modal fade" id="finance-modal" tabindex="-1" aria-labelledby="financeModalLabel" aria-hidden="true"><div class="modal-dialog modal-lg modal-dialog-centered"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="financeModalLabel">Tạo Phiếu</h5><button type="button" class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><form><div class="row g-3"><div class="col-md-6"><label class="form-label">Ngày</label><input type="date" class="form-control"></div><div class="col-md-6"><label class="form-label">Số tiền</label><input type="number" class="form-control"></div><div class="col-md-6"><label class="form-label">Hạng mục</label><select class="form-select"><option>Thanh toán ĐH</option><option>Chi phí vật tư</option></select></div><div class="col-md-6"><label class="form-label" id="finance-entity-label">Khách hàng</label><select class="form-select"><option>Blue Exchange</option><option>Nhà cung cấp Hóa Chất ABC</option></select></div><div class="col-12"><label class="form-label">Ghi chú</label><textarea class="form-control" rows="3"></textarea></div></div></form></div><div class="modal-footer"><button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Đóng</button><button type="button" class="btn btn-primary"><i class="fas fa-save me-2"></i>Lưu Phiếu</button></div></div></div></div>
<!-- Role Modal -->
<div class="modal fade" id="role-modal" tabindex="-1" aria-labelledby="roleModalLabel" aria-hidden="true"><div class="modal-dialog modal-dialog-centered"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="roleModalLabel">Thêm/Sửa</h5><button type="button" class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><form><div class="mb-3"><label for="roleName" class="form-label">Tên Vai Trò</label><input type="text" id="roleName" class="form-control"></div></form></div><div class="modal-footer"><button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Đóng</button><button type="button" class="btn btn-primary">Lưu</button></div></div></div></div>
<!-- Stage Modal -->
<div class="modal fade" id="stage-modal" tabindex="-1" aria-labelledby="stageModalLabel" aria-hidden="true"><div class="modal-dialog modal-dialog-centered"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="stageModalLabel">Thêm/Sửa</h5><button type="button" class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><form><div class="mb-3"><label class="form-label">Tên công đoạn</label><input type="text" class="form-control"></div><div class="mb-3"><label class="form-label">Đơn giá</label><input type="number" class="form-control"></div></form></div><div class="modal-footer"><button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Đóng</button><button type="button" class="btn btn-primary">Lưu</button></div></div></div></div>
<!-- Account Modal -->
<div class="modal fade" id="account-modal" tabindex="-1" aria-labelledby="accountModalLabel" aria-hidden="true"><div class="modal-dialog modal-lg modal-dialog-centered"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="accountModalLabel">Thêm/Sửa</h5><button type="button" class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><form><div class="row g-3"><div class="col-md-6"><label class="form-label">Tên tài khoản</label><input type="text" class="form-control"></div><div class="col-md-6"><label class="form-label">Loại tài khoản</label><select class="form-select"><option>Tiền mặt</option><option>Chuyển khoản</option></select></div><div class="col-md-6"><label class="form-label">Số dư ban đầu</label><input type="number" class="form-control"></div><div class="col-md-6"><label class="form-label">Trạng thái</label><select class="form-select"><option value="1">Hoạt động</option><option value="0">Tạm khóa</option></select></div></div></form></div><div class="modal-footer"><button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Đóng</button><button type="button" class="btn btn-primary">Lưu</button></div></div></div></div>
<!-- Audit Modal -->
<div class="modal fade" id="audit-modal" tabindex="-1" aria-labelledby="auditModalLabel" aria-hidden="true"><div class="modal-dialog modal-lg modal-dialog-centered"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="auditModalLabel">Thực hiện Kiểm Kê Quỹ</h5><button type="button" class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><form><div class="row g-3"><div class="col-md-6"><label class="form-label">Tài khoản kiểm kê</label><select class="form-select"><option>Quỹ tiền mặt</option><option>TK Vietcombank</option></select></div><div class="col-md-6"><label class="form-label">Ngày kiểm kê</label><input type="date" class="form-control"></div><div class="col-md-6"><label class="form-label">Số dư hệ thống</label><input type="text" class="form-control" value="50,250,000" readonly></div><div class="col-md-6"><label class="form-label">Số dư thực tế</label><input type="number" class="form-control"></div><div class="col-12"><label class="form-label">Ghi chú</label><textarea class="form-control" rows="2"></textarea></div></div></form></div><div class="modal-footer"><button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Hủy</button><button type="button" class="btn btn-primary">Xác nhận</button></div></div></div></div>
<!-- Attendance Modal -->
<div class="modal fade" id="attendance-modal" tabindex="-1" aria-labelledby="attendanceModalLabel" aria-hidden="true"><div class="modal-dialog modal-dialog-centered"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="attendanceModalLabel">Chấm Công Hôm Nay</h5><button type="button" class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><p>Nhân viên: <strong>Binh Mai</strong></p><p>Thời gian hiện tại: <strong id="current-time"></strong></p><p>Bạn muốn thực hiện Check-in hay Check-out?</p></div><div class="modal-footer"><button type="button" class="btn btn-success"><i class="fas fa-sign-in-alt me-2"></i>Check-in</button><button type="button" class="btn btn-danger"><i class="fas fa-sign-out-alt me-2"></i>Check-out</button></div></div></div></div>
<!-- Leave Request Modal -->
<div class="modal fade" id="leave-modal" tabindex="-1" aria-labelledby="leaveModalLabel" aria-hidden="true"><div class="modal-dialog modal-lg modal-dialog-centered"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="leaveModalLabel">Tạo Đơn Xin Nghỉ Phép</h5><button type="button" class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><form><div class="row g-3"><div class="col-md-6"><label class="form-label">Loại phép</label><select class="form-select"><option>Nghỉ phép năm</option><option>Nghỉ ốm</option><option>Nghỉ không lương</option></select></div><div class="col-md-6"><label class="form-label">Số ngày nghỉ</label><input type="number" class="form-control" value="1"></div><div class="col-md-6"><label class="form-label">Từ ngày</label><input type="date" class="form-control"></div><div class="col-md-6"><label class="form-label">Đến ngày</label><input type="date" class="form-control"></div><div class="col-12"><label class="form-label">Lý do</label><textarea class="form-control" rows="3"></textarea></div></div></form></div><div class="modal-footer"><button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Hủy</button><button type="button" class="btn btn-primary"><i class="fas fa-paper-plane me-2"></i>Gửi đơn</button></div></div></div></div>
<!-- Workflow Modal -->
<div class="modal fade" id="workflow-modal" tabindex="-1" aria-labelledby="workflowModalLabel" aria-hidden="true"><div class="modal-dialog modal-lg modal-dialog-centered"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="workflowModalLabel">Thêm/Sửa</h5><button type="button" class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><form><div class="mb-3"><label class="form-label">Tên quy trình</label><input type="text" class="form-control"></div><div class="mb-3"><label class="form-label">Các bước (Enumlist, cách nhau bởi dấu ->)</label><input type="text" class="form-control" placeholder="Trạng thái 1 -> Trạng thái 2 -> ..."></div><div class="mb-3"><label class="form-label">Mô tả</label><textarea class="form-control" rows="3"></textarea></div><div class="row g-3"><div class="col-md-6"><label class="form-label">Người phụ trách</label><input type="text" class="form-control"></div><div class="col-md-6"><label class="form-label">Lead Time (ngày)</label><input type="number" class="form-control"></div></div></form></div><div class="modal-footer"><button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Đóng</button><button type="button" class="btn btn-primary">Lưu</button></div></div></div></div>
<!-- Guide Modal -->
<div class="modal fade" id="guide-modal" tabindex="-1" aria-labelledby="guideModalLabel" aria-hidden="true"><div class="modal-dialog modal-lg modal-dialog-centered"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="guideModalLabel">Thêm/Sửa</h5><button type="button" class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><form><div class="mb-3"><label class="form-label">Tiêu đề hướng dẫn (Tên Module)</label><input type="text" class="form-control"></div><div class="mb-3"><label class="form-label">Nội dung hướng dẫn</label><textarea class="form-control" rows="6"></textarea></div></form></div><div class="modal-footer"><button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Đóng</button><button type="button" class="btn btn-primary">Lưu</button></div></div></div></div>
<!-- Incident Modal -->
<div class="modal fade" id="incident-modal" tabindex="-1" aria-labelledby="incidentModalLabel" aria-hidden="true"><div class="modal-dialog modal-lg modal-dialog-centered"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="incidentModalLabel">Thêm/Sửa</h5><button type="button" class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><form><div class="row g-3"><div class="col-md-6"><label class="form-label">Ngày</label><input type="date" class="form-control"></div><div class="col-md-6"><label class="form-label">Bộ phận</label><select class="form-select"><option>Giặt</option><option>Ủi</option><option>Nhuộm</option></select></div><div class="col-md-6"><label class="form-label">Sản phẩm / Máy</label><input type="text" class="form-control"></div><div class="col-md-6"><label class="form-label">Số lượng ảnh hưởng</label><input type="number" class="form-control"></div><div class="col-12"><label class="form-label">Lỗi phát sinh</label><textarea class="form-control" rows="2"></textarea></div><div class="col-12"><label class="form-label">Hướng xử lý</label><textarea class="form-control" rows="2"></textarea></div></div></form></div><div class="modal-footer"><button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Đóng</button><button type="button" class="btn btn-primary">Lưu</button></div></div></div></div>
<!-- Equipment Modal -->
<div class="modal fade" id="equipment-modal" tabindex="-1" aria-labelledby="equipmentModalLabel" aria-hidden="true"><div class="modal-dialog modal-lg modal-dialog-centered"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="equipmentModalLabel">Thêm/Sửa</h5><button type="button" class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><form><div class="row g-3"><div class="col-md-4"><label class="form-label">Ảnh đại diện</label><input type="file" class="form-control"></div><div class="col-md-8"><label class="form-label">Tên thiết bị</label><input type="text" class="form-control"></div><div class="col-md-6"><label class="form-label">Model</label><input type="text" class="form-control"></div><div class="col-md-6"><label class="form-label">Xuất xứ</label><input type="text" class="form-control"></div><div class="col-md-6"><label class="form-label">Ngày sử dụng</label><input type="date" class="form-control"></div><div class="col-md-6"><label class="form-label">Công suất định mức</label><input type="text" class="form-control"></div><div class="col-12"><label class="form-label">Thông số kỹ thuật</label><textarea class="form-control" rows="3"></textarea></div></div></form></div><div class="modal-footer"><button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Đóng</button><button type="button" class="btn btn-primary">Lưu</button></div></div></div></div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>
<script>
document.addEventListener('DOMContentLoaded', function () {
    const mainContentArea = document.getElementById('main-content-area');
    const globalSearchInput = document.getElementById('global-search-input');
    const sidebar = document.getElementById('sidebar');
    const sidebarOverlay = document.getElementById('sidebar-overlay');
    const desktopSidebarToggleBtn = document.getElementById('desktop-sidebar-toggle-btn');
    const mobileSidebarToggleBtn = document.getElementById('mobile-sidebar-toggle-btn');

    // --- START: SỬA LỖI ---
    // Khai báo các biến để lưu trữ các đối tượng biểu đồ.
    // Việc này giúp chúng ta quản lý (hủy và tạo lại) chúng một cách chính xác.
    let planCompletionChartInstance = null;
    let weeklyProductionChartInstance = null;
    let incidentByCategoryChartInstance = null;
    // --- END: SỬA LỖI ---
    
    let bsTooltipList = [];

    const searchPlaceholders = {
        dashboard: 'Tìm kiếm trong tổng quan...',
        orders: 'Tìm kiếm theo mã ĐH, tên khách...',
        products: 'Tìm kiếm theo mã, tên sản phẩm...',
        production: 'Tìm kiếm lô sản xuất, sự cố...',
        payroll: 'Tìm kiếm theo nhân viên, công đoạn...',
        finance: 'Tìm kiếm phiếu thu, chi...',
        accounts: 'Tìm kiếm tài khoản, kiểm kê...',
        delivery: 'Tìm kiếm phiếu giao, khách hàng...',
        'master-data': 'Tìm kiếm dữ liệu nguồn...',
        users: 'Tìm kiếm người dùng...',
        roles: 'Tìm kiếm vai trò...',
        'my-profile': 'Tìm kiếm thông tin cá nhân...',
        attendance: 'Tìm kiếm chấm công theo nhân viên...',
        leave: 'Tìm kiếm đơn nghỉ phép...',
        kpis: 'Tìm kiếm KPIs theo nhân viên, tháng...',
        workflows: 'Tìm kiếm quy trình...',
        'user-guide': 'Tìm kiếm hướng dẫn...',
    };
    
    const viewTemplates = {
        dashboard: `<div class="row"><div class="col-lg-8"><div class="row"><div class="col-6 col-lg-3 mb-4"><div class="card border-start border-primary border-4 h-100"><div class="card-body"><h6 class="text-muted small text-uppercase mb-2">Doanh thu (Tháng)</h6><h4 class="fw-bold mb-0">256.7M</h4></div></div></div><div class="col-6 col-lg-3 mb-4"><div class="card border-start border-success border-4 h-100"><div class="card-body"><h6 class="text-muted small text-uppercase mb-2">Sản lượng (Ngày)</h6><h4 class="fw-bold mb-0">1,850 sp</h4></div></div></div><div class="col-6 col-lg-3 mb-4"><div class="card border-start border-info border-4 h-100"><div class="card-body"><h6 class="text-muted small text-uppercase mb-2">Đúng hẹn</h6><h4 class="fw-bold mb-0">98.5%</h4></div></div></div><div class="col-6 col-lg-3 mb-4"><div class="card border-start border-danger border-4 h-100"><div class="card-body"><h6 class="text-muted small text-uppercase mb-2">Sự cố (Tuần)</h6><h4 class="fw-bold mb-0">3</h4></div></div></div></div><div class="card shadow-sm h-100 mb-4"><div class="card-header">Sản lượng theo Tuần</div><div class="card-body" style="position: relative; min-height:280px;"><canvas id="weeklyProductionChart"></canvas></div></div></div><div class="col-lg-4"><div class="card shadow-sm mb-4"><div class="card-header">Tỷ lệ Hoàn thành Kế hoạch</div><div class="card-body d-flex justify-content-center" style="min-height:200px;"><div id="planCompletionChart"></div></div></div><div class="card shadow-sm mb-4"><div class="card-header">Sự cố theo Bộ phận</div><div class="card-body" style="position: relative; min-height:235px;"><canvas id="incidentByCategoryChart"></canvas></div></div></div></div>`,
                    orders: `<div class="d-flex justify-content-between align-items-center mb-4 flex-wrap gap-2"><h3>Quản lý Đơn hàng</h3><button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#order-modal"><i class="fas fa-plus me-2"></i>Tạo Đơn Hàng Mới</button></div><div class="card shadow-sm"><div class="card-body"><div class="table-responsive"><table class="table table-hover align-middle"><thead><tr><th>Mã ĐH</th><th>Khách hàng</th><th>Hoàn thành</th><th>Trạng thái</th><th class="text-end">Tổng tiền</th><th class="text-center">Hành động</th></tr></thead><tbody><tr><td>DH-0708A</td><td>An Phước</td><td><div class="progress" role="progressbar" style="height: 20px;"><div class="progress-bar bg-primary" style="width: 10%">10%</div></div></td><td><span class="badge bg-primary">Mới nhận</span></td><td class="text-end">22.5M</td><td class="text-center"><div class="btn-group btn-group-sm"><button class="btn btn-outline-warning" data-bs-toggle="modal" data-bs-target="#order-modal"><i class="fas fa-edit"></i></button><div class="btn-group btn-group-sm" role="group"><button type="button" class="btn btn-outline-secondary dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false"><i class="fas fa-sync-alt"></i></button><ul class="dropdown-menu"><li><a class="dropdown-item" href="#">Sản xuất</a></li></ul></div></div></td></tr><tr><td>DH-0707B</td><td>Blue Exchange</td><td><div class="progress" role="progressbar" style="height: 20px;"><div class="progress-bar bg-warning" style="width: 50%">50%</div></div></td><td><span class="badge bg-warning text-dark">Đang sản xuất</span></td><td class="text-end">55.0M</td><td class="text-center"><div class="btn-group btn-group-sm"><button class="btn btn-outline-warning" data-bs-toggle="modal" data-bs-target="#order-modal"><i class="fas fa-edit"></i></button><div class="btn-group btn-group-sm" role="group"><button type="button" class="btn btn-outline-secondary dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false"><i class="fas fa-sync-alt"></i></button><ul class="dropdown-menu"><li><a class="dropdown-item" href="#">Hoàn thành</a></li></ul></div></div></td></tr><tr><td>DH-0706C</td><td>Canifa</td><td><div class="progress" role="progressbar" style="height: 20px;"><div class="progress-bar bg-success" style="width: 100%">100%</div></div></td><td><span class="badge bg-success">Hoàn thành</span></td><td class="text-end">120.0M</td><td class="text-center"><div class="btn-group btn-group-sm"><button class="btn btn-outline-warning" data-bs-toggle="modal" data-bs-target="#order-modal"><i class="fas fa-edit"></i></button></div></td></tr><tr><td>DH-0705D</td><td>Owen</td><td><div class="progress" role="progressbar" style="height: 20px;"><div class="progress-bar bg-danger" style="width: 0%">0%</div></div></td><td><span class="badge bg-danger">Đã hủy</span></td><td class="text-end">30.0M</td><td class="text-center"><div class="btn-group btn-group-sm"><button class="btn btn-outline-warning" data-bs-toggle="modal" data-bs-target="#order-modal"><i class="fas fa-edit"></i></button></div></td></tr></tbody></table></div></div></div>`,
        products: `<div class="d-flex justify-content-between align-items-center mb-4"><h3>Quản lý Sản phẩm</h3><button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#product-modal"><i class="fas fa-plus me-2"></i>Thêm</button></div><div class="card shadow-sm"><div class="card-body"><div class="table-responsive"><table class="table table-hover align-middle"><thead><tr><th>Mã SP</th><th>Tên sản phẩm</th><th>Khách hàng</th><th>Trạng thái</th><th class="text-center">Hành động</th></tr></thead><tbody><tr><td>QJ-AP-01</td><td>Quần Jean Wash Nam</td><td>An Phước</td><td><span class="badge bg-success">Đang áp dụng</span></td><td class="text-center"><div class="btn-group btn-group-sm"><button class="btn btn-outline-warning" data-bs-toggle="modal" data-bs-target="#product-modal"><i class="fas fa-edit"></i></button><button class="btn btn-outline-danger"><i class="fas fa-trash"></i></button></div></td></tr><tr><td>SM-AP-02</td><td>Áo Sơ Mi Nữ</td><td>An Phước</td><td><span class="badge bg-success">Đang áp dụng</span></td><td class="text-center"><div class="btn-group btn-group-sm"><button class="btn btn-outline-warning" data-bs-toggle="modal" data-bs-target="#product-modal"><i class="fas fa-edit"></i></button><button class="btn btn-outline-danger"><i class="fas fa-trash"></i></button></div></td></tr><tr><td>AK-BX-03</td><td>Áo Khoác Dù</td><td>Blue Exchange</td><td><span class="badge bg-success">Đang áp dụng</span></td><td class="text-center"><div class="btn-group btn-group-sm"><button class="btn btn-outline-warning" data-bs-toggle="modal" data-bs-target="#product-modal"><i class="fas fa-edit"></i></button><button class="btn btn-outline-danger"><i class="fas fa-trash"></i></button></div></td></tr><tr><td>VJ-CN-04</td><td>Váy Jean Nữ</td><td>Canifa</td><td><span class="badge bg-danger">Ngưng áp dụng</span></td><td class="text-center"><div class="btn-group btn-group-sm"><button class="btn btn-outline-warning" data-bs-toggle="modal" data-bs-target="#product-modal"><i class="fas fa-edit"></i></button><button class="btn btn-outline-danger"><i class="fas fa-trash"></i></button></div></td></tr></tbody></table></div></div></div>`,
        production: `<div class="d-flex justify-content-between align-items-center mb-4"><h3>Quản lý Sản xuất</h3></div><div class="card shadow-sm"><div class="card-header"><ul class="nav nav-tabs card-header-tabs nav-tabs-responsive"><li class="nav-item"><a class="nav-link active" data-bs-toggle="tab" href="#tab-plan">Kế hoạch Sản xuất</a></li><li class="nav-item"><a class="nav-link" data-bs-toggle="tab" href="#tab-log">Nhật ký Sản xuất</a></li><li class="nav-item"><a class="nav-link" data-bs-toggle="tab" href="#tab-incidents">Báo cáo Sự cố</a></li></ul></div><div class="card-body"><div class="tab-content pt-3"><div class="tab-pane active" id="tab-plan"><div class="kanban-container"><div class="kanban-column"><h5><i class="fas fa-box-open text-secondary me-2"></i>Mới nhận</h5><div class="card my-2 kanban-card"><div class="card-body p-3"><h6 class="fw-bold mb-1">LÔ-0708-AP01</h6><small>ĐH: DH-0708A | SP: Quần Jean</small><div class="progress mt-2" role="progressbar" style="height: 10px;"><div class="progress-bar bg-primary" style="width: 10%;"></div></div><div class="d-flex justify-content-between mt-2 pt-2 border-top"><small class="text-muted"><i class="far fa-calendar-alt me-1"></i> 20/07</small><small><strong>SL: 500</strong></small></div></div><div class="card-footer text-center"><button class="btn btn-sm btn-outline-primary" data-bs-toggle="modal" data-bs-target="#scan-modal"><i class="fas fa-edit me-1"></i> Ghi nhật ký</button></div></div></div><div class="kanban-column"><h5><i class="fas fa-tint text-primary me-2"></i>Giặt/Nhuộm</h6><div class="card my-2 kanban-card"><div class="card-body p-3"><h6 class="fw-bold mb-1">LÔ-0707B-01</h6><small>ĐH: DH-0707B | SP: Áo Khoác</small><div class="progress mt-2" role="progressbar" style="height: 10px;"><div class="progress-bar bg-warning" style="width: 50%;"></div></div><div class="d-flex justify-content-between mt-2 pt-2 border-top"><small class="text-muted"><i class="far fa-calendar-alt me-1"></i> 18/07</small><small><strong>SL: 1000</strong></small></div></div><div class="card-footer text-center"><button class="btn btn-sm btn-outline-primary" data-bs-toggle="modal" data-bs-target="#scan-modal"><i class="fas fa-edit me-1"></i> Ghi nhật ký</button></div></div></div><div class="kanban-column"><h5><i class="fas fa-check-circle text-success me-2"></i>Hoàn thành</h6><div class="card my-2 kanban-card"><div class="card-body p-3"><h6 class="fw-bold mb-1">LÔ-0706C</h6><small>ĐH: DH-0706C | SP: Váy Jean</small><div class="progress mt-2" role="progressbar" style="height: 10px;"><div class="progress-bar bg-success" style="width: 100%;"></div></div><div class="d-flex justify-content-between mt-2 pt-2 border-top"><small class="text-muted"><i class="far fa-calendar-alt me-1"></i> 15/07</small><small><strong>SL: 3000</strong></small></div></div><div class="card-footer text-center"><button class="btn btn-sm btn-outline-primary" data-bs-toggle="modal" data-bs-target="#scan-modal"><i class="fas fa-edit me-1"></i> Ghi nhật ký</button></div></div></div></div></div><div class="tab-pane" id="tab-log"><div class="d-flex justify-content-between align-items-center mb-3"><h5 class="mb-0">Lịch sử ghi nhận sản xuất</h5><button class="btn btn-success" data-bs-toggle="modal" data-bs-target="#scan-modal"><i class="fas fa-edit me-2"></i>Ghi Nhật Ký Mới</button></div><div class="table-responsive"><table class="table table-sm table-bordered table-striped"><thead><th>Ngày giờ</th><th>Nhân viên</th><th>Mã Lô</th><th>Công đoạn</th><th class="text-end">SL</th><th class="text-end">Hư</th></tr></thead><tbody><tr><td>09/07 10:30</td><td>Nguyễn Văn A</td><td>LÔ-0707B-01</td><td>Giặt thô</td><td class="text-end">500</td><td class="text-end">5</td></tr><tr><td>08/07 14:00</td><td>Trần Thị B</td><td>LÔ-0706C</td><td>Ủi hoàn thiện</td><td class="text-end">1500</td><td class="text-end">10</td></tr><tr><td>08/07 08:15</td><td>Lê Văn C</td><td>LÔ-0706C</td><td>Wash rách</td><td class="text-end">1500</td><td class="text-end">12</td></tr></tbody></table></div></div><div class="tab-pane" id="tab-incidents"><div class="d-flex justify-content-end mb-3"><button class="btn btn-danger" data-bs-toggle="modal" data-bs-target="#incident-modal"><i class="fas fa-exclamation-triangle me-2"></i>Báo cáo Sự cố mới</button></div><div class="table-responsive"><table class="table table-hover align-middle"><thead><tr><th>Ngày</th><th>Bộ phận</th><th>Sản phẩm/Máy</th><th>Lỗi</th><th>Trạng thái</th><th class="text-center">Hành động</th></tr></thead><tbody><tr><td>10/07/2025</td><td>Nhuộm</td><td>Máy Nhuộm 02</td><td>Rò rỉ hóa chất</td><td><span class="badge bg-danger">Chưa xử lý</span></td><td class="text-center"><div class="btn-group btn-group-sm"><button class="btn btn-outline-warning" data-bs-toggle="modal" data-bs-target="#incident-modal"><i class="fas fa-edit"></i></button><button class="btn btn-outline-danger"><i class="fas fa-trash"></i></button></div></td></tr><tr><td>09/07/2025</td><td>Giặt</td><td>LÔ-0707B-01</td><td>Vải bị rách</td><td><span class="badge bg-success">Đã xử lý</span></td><td class="text-center"><div class="btn-group btn-group-sm"><button class="btn btn-outline-warning" data-bs-toggle="modal" data-bs-target="#incident-modal"><i class="fas fa-edit"></i></button><button class="btn btn-outline-danger"><i class="fas fa-trash"></i></button></div></td></tr><tr><td>08/07/2025</td><td>Ủi</td><td>Bàn ủi hơi 05</td><td>Mất hơi</td><td><span class="badge bg-success">Đã xử lý</span></td><td class="text-center"><div class="btn-group btn-group-sm"><button class="btn btn-outline-warning" data-bs-toggle="modal" data-bs-target="#incident-modal"><i class="fas fa-edit"></i></button><button class="btn btn-outline-danger"><i class="fas fa-trash"></i></button></div></td></tr><tr><td>07/07/2025</td><td>Giặt</td><td>LÔ-0706C</td><td>Ra màu không đều</td><td><span class="badge bg-info">Đang xử lý</span></td><td class="text-center"><div class="btn-group btn-group-sm"><button class="btn btn-outline-warning" data-bs-toggle="modal" data-bs-target="#incident-modal"><i class="fas fa-edit"></i></button><button class="btn btn-outline-danger"><i class="fas fa-trash"></i></button></div></td></tr></tbody></table></div></div></div></div></div>`,
        finance: `<div class="d-flex justify-content-between align-items-center mb-4"><h3>Quản lý Thu - Chi</h3></div><div class="card shadow-sm"><div class="card-header"><ul class="nav nav-tabs card-header-tabs nav-tabs-responsive"><li class="nav-item"><a class="nav-link active" data-bs-toggle="tab" href="#tab-thu">Phiếu Thu</a></li><li class="nav-item"><a class="nav-link" data-bs-toggle="tab" href="#tab-chi">Phiếu Chi</a></li><li class="nav-item"><a class="nav-link" data-bs-toggle="tab" href="#tab-tonghop">Tổng hợp</a></li></ul></div><div class="card-body"><div class="tab-content pt-3"><div class="tab-pane active" id="tab-thu"><div class="d-flex justify-content-end mb-3"><button class="btn btn-sm btn-success" data-bs-toggle="modal" data-bs-target="#finance-modal" data-type="receipt"><i class="fas fa-plus me-2"></i>Tạo phiếu Thu</button></div><div class="table-responsive"><table class="table table-sm table-hover align-middle"><thead><tr><th>Ngày</th><th>Nội dung</th><th>Trạng thái</th><th class="text-end">Số tiền</th><th class="text-center">Hành động</th></tr></thead><tbody><tr><td>08/07</td><td>An Phước thanh toán ĐH-0708A</td><td><span class="badge bg-success">Đã duyệt</span></td><td class="text-end">22.5M</td><td class="text-center"><div class="btn-group btn-group-sm"><button class="btn btn-outline-warning" data-bs-toggle="modal" data-bs-target="#finance-modal" data-type="receipt"><i class="fas fa-edit"></i></button></div></td></tr><tr><td>05/07</td><td>Canifa thanh toán ĐH-0706C</td><td><span class="badge bg-success">Đã duyệt</span></td><td class="text-end">120.0M</td><td class="text-center"><div class="btn-group btn-group-sm"><button class="btn btn-outline-warning" data-bs-toggle="modal" data-bs-target="#finance-modal" data-type="receipt"><i class="fas fa-edit"></i></button></div></td></tr></tbody></table></div></div><div class="tab-pane" id="tab-chi"><div class="d-flex justify-content-end mb-3"><button class="btn btn-sm btn-danger" data-bs-toggle="modal" data-bs-target="#finance-modal" data-type="payment"><i class="fas fa-plus me-2"></i>Tạo phiếu Chi</button></div><div class="table-responsive"><table class="table table-sm table-hover align-middle"><thead><tr><th>Ngày</th><th>Nội dung</th><th>Trạng thái</th><th class="text-end">Số tiền</th><th class="text-center">Hành động</th></tr></thead><tbody><tr><td>07/07</td><td>Chi tiền điện tháng 6</td><td><span class="badge bg-success">Đã duyệt</span></td><td class="text-end">(15.0M)</td><td class="text-center"><div class="btn-group btn-group-sm"><button class="btn btn-outline-warning" data-bs-toggle="modal" data-bs-target="#finance-modal" data-type="payment"><i class="fas fa-edit"></i></button></div></td></tr><tr><td>06/07</td><td>Mua hóa chất từ NCC XYZ</td><td><span class="badge bg-warning text-dark">Chờ duyệt</span></td><td class="text-end">(10.2M)</td><td class="text-center"><div class="btn-group btn-group-sm"><button class="btn btn-outline-warning" data-bs-toggle="modal" data-bs-target="#finance-modal" data-type="payment"><i class="fas fa-edit"></i></button><div class="btn-group btn-group-sm" role="group"><button type="button" class="btn btn-outline-secondary dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false"><i class="fas fa-check"></i></button><ul class="dropdown-menu"><li><a class="dropdown-item" href="#">Duyệt</a></li><li><a class="dropdown-item" href="#">Từ chối</a></li></ul></div></div></td></tr></tbody></table></div></div><div class="tab-pane" id="tab-tonghop"><h5 class="mb-3">Tổng hợp trong kỳ</h5><div class="row mt-3"><div class="col-6 col-lg-4 mb-3"><div class="card text-center text-bg-success h-100"><div class="card-header">TỔNG THU</div><div class="card-body fs-4 fw-bold">142.5M</div></div></div><div class="col-6 col-lg-4 mb-3"><div class="card text-center text-bg-danger h-100"><div class="card-header">TỔNG CHI</div><div class="card-body fs-4 fw-bold">(25.2M)</div></div></div><div class="col-12 col-lg-4 mb-3"><div class="card text-center text-bg-primary h-100"><div class="card-header">LỢI NHUẬN</div><div class="card-body fs-4 fw-bold">117.3M</div></div></div></div><hr class="my-4"><h5 class="mb-3">Bảng kê chi tiết</h5><div class="table-responsive"><table class="table table-sm table-bordered"><thead><tr class="table-light"><th>Ngày</th><th>Loại</th><th>Nội dung</th><th class="text-end">Số tiền</th></tr></thead><tbody><tr><td>08/07</td><td><span class="badge text-bg-success">THU</span></td><td>An Phước thanh toán ĐH-0708A</td><td class="text-end text-success">+ 22,500,000</td></tr><tr><td>07/07</td><td><span class="badge text-bg-danger">CHI</span></td><td>Chi tiền điện tháng 6</td><td class="text-end text-danger">- 15,000,000</td></tr><tr><td>06/07</td><td><span class="badge text-bg-danger">CHI</span></td><td>Mua hóa chất từ NCC XYZ</td><td class="text-end text-danger">- 10,200,000</td></tr><tr><td>05/07</td><td><span class="badge text-bg-success">THU</span></td><td>Canifa thanh toán ĐH-0706C</td><td class="text-end text-success">+ 120,000,000</td></tr></tbody></table></div></div></div></div></div>`,
        accounts: `<div class="d-flex justify-content-between align-items-center mb-4"><h3>Quản lý Tài khoản</h3></div><div class="card shadow-sm"><div class="card-header"><ul class="nav nav-tabs card-header-tabs nav-tabs-responsive"><li class="nav-item"><a class="nav-link active" data-bs-toggle="tab" href="#tab-accounts">Danh sách tài khoản</a></li><li class="nav-item"><a class="nav-link" data-bs-toggle="tab" href="#tab-audits">Lịch sử kiểm kê quỹ</a></li></ul></div><div class="card-body"><div class="tab-content pt-3"><div class="tab-pane active" id="tab-accounts"><div class="d-flex justify-content-end mb-3"><button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#account-modal"><i class="fas fa-plus me-2"></i>Thêm</button></div><div class="table-responsive"><table class="table table-hover align-middle"><thead><tr><th>Tên tài khoản</th><th>Loại</th><th class="text-end">Số dư hiện tại</th><th>Trạng thái</th><th class="text-center">Hành động</th></tr></thead><tbody><tr><td>Quỹ tiền mặt</td><td>Tiền mặt</td><td class="text-end">50,250,000đ</td><td><span class="badge bg-success">Hoạt động</span></td><td class="text-center"><div class="btn-group btn-group-sm"><button class="btn btn-outline-warning" data-bs-toggle="modal" data-bs-target="#account-modal"><i class="fas fa-edit"></i></button><button class="btn btn-outline-danger"><i class="fas fa-trash"></i></button></div></td></tr><tr><td>TK Vietcombank</td><td>Chuyển khoản</td><td class="text-end">1,250,600,000đ</td><td><span class="badge bg-success">Hoạt động</span></td><td class="text-center"><div class="btn-group btn-group-sm"><button class="btn btn-outline-warning" data-bs-toggle="modal" data-bs-target="#account-modal"><i class="fas fa-edit"></i></button><button class="btn btn-outline-danger"><i class="fas fa-trash"></i></button></div></td></tr><tr><td>TK Techcombank</td><td>Chuyển khoản</td><td class="text-end">345,000,000đ</td><td><span class="badge bg-success">Hoạt động</span></td><td class="text-center"><div class="btn-group btn-group-sm"><button class="btn btn-outline-warning" data-bs-toggle="modal" data-bs-target="#account-modal"><i class="fas fa-edit"></i></button><button class="btn btn-outline-danger"><i class="fas fa-trash"></i></button></div></td></tr><tr><td>Quỹ công đoàn</td><td>Tiền mặt</td><td class="text-end">12,500,000đ</td><td><span class="badge bg-danger">Tạm khóa</span></td><td class="text-center"><div class="btn-group btn-group-sm"><button class="btn btn-outline-warning" data-bs-toggle="modal" data-bs-target="#account-modal"><i class="fas fa-edit"></i></button><button class="btn btn-outline-danger"><i class="fas fa-trash"></i></button></div></td></tr></tbody></table></div></div><div class="tab-pane" id="tab-audits"><div class="d-flex justify-content-end mb-3"><button class="btn btn-success" data-bs-toggle="modal" data-bs-target="#audit-modal"><i class="fas fa-tasks me-2"></i>Thực hiện kiểm kê</button></div><div class="table-responsive"><table class="table table-bordered table-sm"><thead><th>Ngày</th><th>Tài khoản</th><th class="text-end">Dư hệ thống</th><th class="text-end">Dư thực tế</th><th class="text-end">Chênh lệch</th><th>Người thực hiện</th><th>Trạng thái</th></tr></thead><tbody><tr><td>01/07/2025</td><td>Quỹ tiền mặt</td><td class="text-end">50,250,000</td><td class="text-end">50,250,000</td><td class="text-end text-success">0</td><td>ketoan01</td><td><span class="badge bg-success">Khớp</span></td></tr><tr><td>01/06/2025</td><td>Quỹ tiền mặt</td><td class="text-end">45,000,000</td><td class="text-end">44,950,000</td><td class="text-end text-danger">-50,000</td><td>ketoan01</td><td><span class="badge bg-danger">Lệch</span></td></tr></tbody></table></div></div></div></div></div>`,
        delivery: `<div class="d-flex justify-content-between align-items-center mb-4"><h3>Quản lý Giao hàng</h3><button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#delivery-modal"><i class="fas fa-shipping-fast me-2"></i>Tạo Phiếu Giao Hàng</button></div><div class="card shadow-sm"><div class="card-body"><div class="table-responsive"><table class="table table-hover align-middle"><thead><tr><th>Mã Phiếu</th><th>Ngày Giao</th><th>Khách hàng</th><th>Nội dung</th><th class="text-center">Trạng thái</th><th class="text-center">Hành động</th></tr></thead><tbody><tr><td>GH-0709A</td><td>09/07/2025</td><td>Canifa</td><td>LÔ-0706C (Váy Jean, 3000)</td><td class="text-center"><span class="badge bg-success">Đã giao</span></td><td class="text-center"><div class="btn-group btn-group-sm"><button class="btn btn-outline-info" title="In phiếu"><i class="fas fa-print"></i></button></div></td></tr><tr><td>GH-0709B</td><td>09/07/2025</td><td>An Phước</td><td>LÔ-0708-AP01 (Quần Jean, 500)</td><td class="text-center"><span class="badge bg-info">Đang giao</span></td><td class="text-center"><div class="btn-group btn-group-sm" role="group"><button type="button" class="btn btn-outline-secondary dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false"><i class="fas fa-sync-alt"></i></button><ul class="dropdown-menu"><li><a class="dropdown-item" href="#">Hoàn tất giao</a></li></ul></div></td></tr><tr><td>-</td><td>-</td><td>Blue Exchange</td><td>LÔ-0707B (Áo Khoác, 1000)</td><td class="text-center"><span class="badge bg-warning text-dark">Chờ giao</span></td><td class="text-center"><div class="btn-group btn-group-sm" role="group"><button type="button" class="btn btn-outline-secondary dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false"><i class="fas fa-sync-alt"></i></button><ul class="dropdown-menu"><li><a class="dropdown-item" href="#">Bắt đầu giao</a></li></ul></div></td></tr><tr><td>-</td><td>-</td><td>An Phước</td><td>LÔ-0708-AP02 (Áo Sơ Mi, 200)</td><td class="text-center"><span class="badge bg-warning text-dark">Chờ giao</span></td><td class="text-center"><div class="btn-group btn-group-sm" role="group"><button type="button" class="btn btn-outline-secondary dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false"><i class="fas fa-sync-alt"></i></button><ul class="dropdown-menu"><li><a class="dropdown-item" href="#">Bắt đầu giao</a></li></ul></div></td></tr></tbody></table></div></div></div>`,
        payroll: `<div class="d-flex justify-content-between align-items-center mb-4"><h3>Báo cáo Lương sản phẩm</h3><button class="btn btn-success"><i class="fas fa-file-excel me-2"></i>Xuất Báo Cáo Excel</button></div><div class="card shadow-sm"><div class="card-header"><div class="row align-items-end g-3"><div class="col-md-4"><label class="form-label">Chọn nhân viên</label><select class="form-select"><option selected>Tất cả</option></select></div><div class="col-md-3"><label class="form-label">Từ ngày</label><input type="date" class="form-control"></div><div class="col-md-3"><label class="form-label">Đến ngày</label><input type="date" class="form-control"></div><div class="col-md-2"><button class="btn btn-primary w-100">Lọc</button></div></div></div><div class="card-body"><div class="table-responsive"><table class="table table-sm table-bordered"><thead><tr><th>Ngày</th><th>Nhân viên</th><th>Mã Lô</th><th>Công đoạn</th><th class="text-end">SL</th><th class="text-end">Đơn giá</th><th class="text-end">Thành tiền</th></tr></thead><tbody><tr><td>09/07</td><td>Nguyễn Văn A</td><td>LÔ-0707B-01</td><td>Giặt thô</td><td class="text-end">500</td><td class="text-end">500đ</td><td class="text-end">250,000đ</td></tr></tbody></table></div></div></div>`,
        'master-data': `<div class="d-flex justify-content-between align-items-center mb-4"><h3>Dữ liệu nguồn</h3></div><div class="card shadow-sm"><div class="card-header"><ul class="nav nav-tabs card-header-tabs nav-tabs-responsive"><li class="nav-item"><a class="nav-link active" data-bs-toggle="tab" href="#tab-customers">Khách hàng</a></li><li class="nav-item"><a class="nav-link" data-bs-toggle="tab" href="#tab-stages">Công đoạn</a></li><li class="nav-item"><a class="nav-link" data-bs-toggle="tab" href="#tab-equipment">Thiết bị</a></li></ul></div><div class="card-body"><div class="tab-content pt-3"><div class="tab-pane active" id="tab-customers"><div class="d-flex justify-content-end mb-3"><button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#customer-modal"><i class="fas fa-plus me-2"></i>Thêm</button></div><div class="table-responsive"><table class="table table-hover align-middle"><thead><tr><th>Mã KH</th><th>Tên công ty</th><th>SĐT</th><th>Trạng thái</th><th class="text-center">Hành động</th></tr></thead><tbody><tr><td>AP-001</td><td>An Phước</td><td>0909...</td><td><span class="badge bg-success">Hoạt động</span></td><td class="text-center"><div class="btn-group btn-group-sm"><button class="btn btn-outline-warning" data-bs-toggle="modal" data-bs-target="#customer-modal"><i class="fas fa-edit"></i></button><button class="btn btn-outline-danger"><i class="fas fa-trash"></i></button></div></td></tr><tr><td>BX-002</td><td>Blue Exchange</td><td>0987...</td><td><span class="badge bg-success">Hoạt động</span></td><td class="text-center"><div class="btn-group btn-group-sm"><button class="btn btn-outline-warning" data-bs-toggle="modal" data-bs-target="#customer-modal"><i class="fas fa-edit"></i></button><button class="btn btn-outline-danger"><i class="fas fa-trash"></i></button></div></td></tr><tr><td>CF-003</td><td>Canifa</td><td>0912...</td><td><span class="badge bg-success">Hoạt động</span></td><td class="text-center"><div class="btn-group btn-group-sm"><button class="btn btn-outline-warning" data-bs-toggle="modal" data-bs-target="#customer-modal"><i class="fas fa-edit"></i></button><button class="btn btn-outline-danger"><i class="fas fa-trash"></i></button></div></td></tr><tr><td>OW-004</td><td>Owen Fashion</td><td>0934...</td><td><span class="badge bg-danger">Ngưng giao dịch</span></td><td class="text-center"><div class="btn-group btn-group-sm"><button class="btn btn-outline-warning" data-bs-toggle="modal" data-bs-target="#customer-modal"><i class="fas fa-edit"></i></button><button class="btn btn-outline-danger"><i class="fas fa-trash"></i></button></div></td></tr></tbody></table></div></div><div class="tab-pane" id="tab-stages"><div class="d-flex justify-content-end mb-3"><button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#stage-modal"><i class="fas fa-plus me-2"></i>Thêm</button></div><div class="table-responsive"><table class="table table-hover align-middle"><thead><tr><th>Tên công đoạn</th><th class="text-end">Đơn giá</th><th>Trạng thái</th><th class="text-center">Hành động</th></tr></thead><tbody><tr><td>Giặt thô</td><td class="text-end">500đ</td><td><span class="badge bg-success">Áp dụng</span></td><td class="text-center"><div class="btn-group btn-group-sm"><button class="btn btn-outline-warning" data-bs-toggle="modal" data-bs-target="#stage-modal"><i class="fas fa-edit"></i></button><button class="btn btn-outline-danger"><i class="fas fa-trash"></i></button></div></td></tr><tr><td>Nhuộm</td><td class="text-end">2,000đ</td><td><span class="badge bg-success">Áp dụng</span></td><td class="text-center"><div class="btn-group btn-group-sm"><button class="btn btn-outline-warning" data-bs-toggle="modal" data-bs-target="#stage-modal"><i class="fas fa-edit"></i></button><button class="btn btn-outline-danger"><i class="fas fa-trash"></i></button></div></td></tr><tr><td>Wash rách</td><td class="text-end">1,500đ</td><td><span class="badge bg-success">Áp dụng</span></td><td class="text-center"><div class="btn-group btn-group-sm"><button class="btn btn-outline-warning" data-bs-toggle="modal" data-bs-target="#stage-modal"><i class="fas fa-edit"></i></button><button class="btn btn-outline-danger"><i class="fas fa-trash"></i></button></div></td></tr><tr><td>Ủi hoàn thiện</td><td class="text-end">1,000đ</td><td><span class="badge bg-danger">Không áp dụng</span></td><td class="text-center"><div class="btn-group btn-group-sm"><button class="btn btn-outline-warning" data-bs-toggle="modal" data-bs-target="#stage-modal"><i class="fas fa-edit"></i></button><button class="btn btn-outline-danger"><i class="fas fa-trash"></i></button></div></td></tr></tbody></table></div></div><div class="tab-pane" id="tab-equipment"><div class="d-flex justify-content-end mb-3"><button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#equipment-modal"><i class="fas fa-plus me-2"></i>Thêm</button></div><div class="table-responsive"><table class="table table-hover align-middle"><thead><tr><th>Ảnh</th><th>Tên thiết bị</th><th>Model</th><th>Ngày SD</th><th>Trạng thái</th><th class="text-center">Hành động</th></tr></thead><tbody><tr><td><img src="https://via.placeholder.com/50" class="thumb-image rounded"></td><td>Máy giặt công nghiệp</td><td>LG-1024</td><td>01/01/2022</td><td><span class="badge bg-success">Hoạt động</span></td><td class="text-center"><div class="btn-group btn-group-sm"><button class="btn btn-outline-warning" data-bs-toggle="modal" data-bs-target="#equipment-modal"><i class="fas fa-edit"></i></button><button class="btn btn-outline-danger"><i class="fas fa-trash"></i></button></div></td></tr><tr><td><img src="https://via.placeholder.com/50" class="thumb-image rounded"></td><td>Máy sấy công nghiệp</td><td>SS-DR-200</td><td>05/03/2021</td><td><span class="badge bg-success">Hoạt động</span></td><td class="text-center"><div class="btn-group btn-group-sm"><button class="btn btn-outline-warning" data-bs-toggle="modal" data-bs-target="#equipment-modal"><i class="fas fa-edit"></i></button><button class="btn btn-outline-danger"><i class="fas fa-trash"></i></button></div></td></tr><tr><td><img src="https://via.placeholder.com/50" class="thumb-image rounded"></td><td>Bàn ủi hơi</td><td>PH-S23</td><td>10/11/2023</td><td><span class="badge bg-success">Hoạt động</span></td><td class="text-center"><div class="btn-group btn-group-sm"><button class="btn btn-outline-warning" data-bs-toggle="modal" data-bs-target="#equipment-modal"><i class="fas fa-edit"></i></button><button class="btn btn-outline-danger"><i class="fas fa-trash"></i></button></div></td></tr><tr><td><img src="https://via.placeholder.com/50" class="thumb-image rounded"></td><td>Máy nhuộm tự động</td><td>DYE-X1</td><td>02/08/2020</td><td><span class="badge bg-danger">Bảo trì</span></td><td class="text-center"><div class="btn-group btn-group-sm"><button class="btn btn-outline-warning" data-bs-toggle="modal" data-bs-target="#equipment-modal"><i class="fas fa-edit"></i></button><button class="btn btn-outline-danger"><i class="fas fa-trash"></i></button></div></td></tr></tbody></table></div></div></div></div></div>`,
        users: `<div class="d-flex justify-content-between align-items-center mb-4"><h3>Quản lý Người Dùng</h3><button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#user-modal"><i class="fas fa-user-plus me-2"></i>Thêm mới</button></div><div class="card shadow-sm"><div class="card-body"><div class="table-responsive"><table class="table table-hover align-middle"><thead><tr><th>Tên hiển thị</th><th>Email</th><th>Vai trò</th><th>Trạng thái</th><th class="text-center">Hành động</th></tr></thead><tbody><tr><td>Binh Mai</td><td>binh.mai@email.com</td><td><span class="badge bg-primary">Admin</span></td><td><span class="badge bg-success">Hoạt động</span></td><td class="text-center"><div class="btn-group btn-group-sm"><button class="btn btn-outline-warning" data-bs-toggle="modal" data-bs-target="#user-modal"><i class="fas fa-edit"></i></button><button class="btn btn-outline-danger"><i class="fas fa-trash"></i></button></div></td></tr><tr><td>Nguyễn Văn B</td><td>quanly01@email.com</td><td><span class="badge bg-info text-dark">Quản lý</span></td><td><span class="badge bg-success">Hoạt động</span></td><td class="text-center"><div class="btn-group btn-group-sm"><button class="btn btn-outline-warning" data-bs-toggle="modal" data-bs-target="#user-modal"><i class="fas fa-edit"></i></button><button class="btn btn-outline-danger"><i class="fas fa-trash"></i></button></div></td></tr><tr><td>Trần Thị C</td><td>nhanvien01@email.com</td><td><span class="badge bg-secondary">Nhân viên</span></td><td><span class="badge bg-danger">Khóa</span></td><td class="text-center"><div class="btn-group btn-group-sm"><button class="btn btn-outline-warning" data-bs-toggle="modal" data-bs-target="#user-modal"><i class="fas fa-edit"></i></button><button class="btn btn-outline-danger"><i class="fas fa-trash"></i></button></div></td></tr><tr><td>Lê Văn D</td><td>ketoan01@email.com</td><td><span class="badge bg-success">Kế toán</span></td><td><span class="badge bg-success">Hoạt động</span></td><td class="text-center"><div class="btn-group btn-group-sm"><button class="btn btn-outline-warning" data-bs-toggle="modal" data-bs-target="#user-modal"><i class="fas fa-edit"></i></button><button class="btn btn-outline-danger"><i class="fas fa-trash"></i></button></div></td></tr></tbody></table></div></div></div>`,
        roles: `<h3 class="mb-4">Phân quyền & Vai trò</h3><div class="row"><div class="col-md-5"><div class="card shadow-sm"><div class="card-header d-flex justify-content-between align-items-center"><span>Danh sách Vai trò</span><button class="btn btn-sm btn-primary" data-bs-toggle="modal" data-bs-target="#role-modal"><i class="fas fa-plus"></i></button></div><div class="list-group list-group-flush" id="role-list"><a href="#" class="list-group-item list-group-item-action active d-flex justify-content-between align-items-center" data-role="Admin"><div>Admin <span class="badge bg-success ms-2">Hoạt động</span></div><div class="btn-group btn-group-sm"><button class="btn btn-outline-warning border-0" data-bs-toggle="modal" data-bs-target="#role-modal"><i class="fas fa-edit"></i></button><button class="btn btn-outline-danger border-0"><i class="fas fa-trash"></i></button></div></a><a href="#" class="list-group-item list-group-item-action d-flex justify-content-between align-items-center" data-role="Quản lý"><div>Quản lý <span class="badge bg-success ms-2">Hoạt động</span></div><div class="btn-group btn-group-sm"><button class="btn btn-outline-warning border-0" data-bs-toggle="modal" data-bs-target="#role-modal"><i class="fas fa-edit"></i></button><button class="btn btn-outline-danger border-0"><i class="fas fa-trash"></i></button></div></a><a href="#" class="list-group-item list-group-item-action d-flex justify-content-between align-items-center" data-role="Kế toán"><div>Kế toán <span class="badge bg-success ms-2">Hoạt động</span></div><div class="btn-group btn-group-sm"><button class="btn btn-outline-warning border-0" data-bs-toggle="modal" data-bs-target="#role-modal"><i class="fas fa-edit"></i></button><button class="btn btn-outline-danger border-0"><i class="fas fa-trash"></i></button></div></a><a href="#" class="list-group-item list-group-item-action d-flex justify-content-between align-items-center" data-role="Nhân viên"><div>Nhân viên <span class="badge bg-danger ms-2">Vô hiệu hóa</span></div><div class="btn-group btn-group-sm"><button class="btn btn-outline-warning border-0" data-bs-toggle="modal" data-bs-target="#role-modal"><i class="fas fa-edit"></i></button><button class="btn btn-outline-danger border-0"><i class="fas fa-trash"></i></button></div></a></div></div></div><div class="col-md-7"><div class="card shadow-sm"><div class="card-header">Quyền cho vai trò: <strong class="text-primary" id="current-role-name">Admin</strong></div><div class="card-body"><table class="table table-sm table-bordered align-middle"><thead><tr><th>Module</th><th class="text-center">Xem</th><th class="text-center">Thêm</th><th class="text-center">Sửa</th><th class="text-center">Xóa</th></tr></thead><tbody><tr><td>Đơn hàng</td><td class="text-center"><input class="form-check-input" type="checkbox" checked></td><td class="text-center"><input class="form-check-input" type="checkbox" checked></td><td class="text-center"><input class="form-check-input" type="checkbox" checked></td><td class="text-center"><input class="form-check-input" type="checkbox" checked></td></tr><tr><td>Sản xuất</td><td class="text-center"><input class="form-check-input" type="checkbox" checked></td><td class="text-center"><input class="form-check-input" type="checkbox" checked></td><td class="text-center"><input class="form-check-input" type="checkbox" checked></td><td class="text-center"><input class="form-check-input" type="checkbox" disabled></td></tr></tbody></table><div class="text-end mt-3"><button class="btn btn-primary"><i class="fas fa-save me-2"></i>Lưu thay đổi</button></div></div></div></div></div>`,
        'my-profile': `<h3 class="mb-4">Thông tin cá nhân</h3><div class="card shadow-sm"><div class="card-body"><div class="row g-4"><div class="col-md-4 text-center"><img src="https://i.pravatar.cc/150?u=binhmai" class="rounded-circle img-thumbnail mb-3" alt="Avatar"><input type="file" id="avatarUpload" class="d-none"><label for="avatarUpload" class="btn btn-primary"><i class="fas fa-camera me-2"></i>Đổi ảnh đại diện</label></div><div class="col-md-8"><form><h5>Thông tin cơ bản</h5><div class="row g-3 mb-4"><div class="col-md-6"><label class="form-label">Họ và tên</label><input type="text" class="form-control" value="Binh Mai"></div><div class="col-md-6"><label class="form-label">Email</label><input type="email" class="form-control" value="binh.mai@email.com"></div><div class="col-md-6"><label class="form-label">Số điện thoại</label><input type="text" class="form-control" value="0987654321"></div></div><h5>Đổi mật khẩu</h5><div class="row g-3"><div class="col-md-4"><label class="form-label">Mật khẩu cũ</label><input type="password" class="form-control"></div><div class="col-md-4"><label class="form-label">Mật khẩu mới</label><input type="password" class="form-control"></div><div class="col-md-4"><label class="form-label">Xác nhận MK mới</label><input type="password" class="form-control"></div></div><div class="mt-4"><button type="submit" class="btn btn-success"><i class="fas fa-save me-2"></i>Lưu thay đổi</button></div></form></div></div></div></div>`,
        attendance: `<div class="d-flex justify-content-between align-items-center mb-4"><h3>Quản lý Chấm công</h3><button class="btn btn-success" data-bs-toggle="modal" data-bs-target="#attendance-modal"><i class="fas fa-user-clock me-2"></i>Chấm công hôm nay</button></div><div class="card shadow-sm"><div class="card-body"><div class="table-responsive"><table class="table table-hover align-middle"><thead><tr><th>Ngày</th><th>Nhân viên</th><th>Giờ vào</th><th>Giờ ra</th><th class="text-end">Tổng giờ công</th><th class="text-center">Trạng thái</th></tr></thead><tbody><tr><td>09/07/2025</td><td>Nguyễn Văn A</td><td>07:58</td><td>17:05</td><td class="text-end">8.1h</td><td class="text-center"><span class="badge bg-success">Hoàn thành</span></td></tr><tr><td>09/07/2025</td><td>Trần Thị B</td><td>08:15</td><td>17:01</td><td class="text-end">7.8h</td><td class="text-center"><span class="badge bg-success">Hoàn thành</span></td></tr><tr><td>09/07/2025</td><td>Lê Văn C</td><td>07:55</td><td>-</td><td class="text-end">-</td><td class="text-center"><span class="badge bg-info">Đã Check-in</span></td></tr><tr><td>08/07/2025</td><td>Nguyễn Văn A</td><td>08:02</td><td>17:30</td><td class="text-end">8.5h</td><td class="text-center"><span class="badge bg-warning text-dark">Đi muộn</span></td></tr></tbody></table></div></div></div>`,
        leave: `<div class="d-flex justify-content-between align-items-center mb-4"><h3>Quản lý Nghỉ phép</h3><button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#leave-modal"><i class="fas fa-plus me-2"></i>Tạo đơn xin nghỉ phép</button></div><div class="card shadow-sm"><div class="card-body"><div class="table-responsive"><table class="table table-hover align-middle"><thead><tr><th>Nhân viên</th><th>Loại phép</th><th>Lý do</th><th>Từ ngày</th><th>Đến ngày</th><th class="text-center">Trạng thái</th></tr></thead><tbody><tr><td>Trần Thị B</td><td>Nghỉ phép năm</td><td>Việc gia đình</td><td>10/07/2025</td><td>11/07/2025</td><td class="text-center"><span class="badge bg-warning text-dark">Chờ duyệt</span></td></tr><tr><td>Nguyễn Văn A</td><td>Nghỉ ốm</td><td>Ốm, có giấy bác sĩ</td><td>08/07/2025</td><td>08/07/2025</td><td class="text-center"><span class="badge bg-success">Đã duyệt</span></td></tr><tr><td>Lê Văn C</td><td>Nghỉ phép năm</td><td>Du lịch</td><td>15/07/2025</td><td>20/07/2025</td><td class="text-center"><span class="badge bg-danger">Từ chối</span></td></tr><tr><td>Nguyễn Văn A</td><td>Nghỉ không lương</td><td>Việc cá nhân</td><td>12/07/2025</td><td>12/07/2025</td><td class="text-center"><span class="badge bg-warning text-dark">Chờ duyệt</span></td></tr></tbody></table></div></div></div>`,
        kpis: `<div class="d-flex justify-content-between align-items-center mb-4"><h3>Quản lý KPIs</h3></div><div class="card shadow-sm"><div class="card-header"><div class="row g-3 align-items-end"><div class="col-md-4"><label class="form-label">Chọn Tháng</label><input type="month" class="form-control" value="2025-07"></div><div class="col-md-4"><label class="form-label">Chọn Nhân viên</label><select class="form-select"><option>Tất cả</option><option>Nguyễn Văn A</option><option>Trần Thị B</option></select></div><div class="col-md-2"><button class="btn btn-primary w-100">Lọc</button></div></div></div><div class="card-body"><div class="table-responsive"><table class="table table-hover align-middle"><thead><tr><th>Kỳ</th><th>Nhân viên</th><th>Tên KPI</th><th class="text-end">Mục tiêu</th><th class="text-end">Thực tế</th><th class="text-center">Kết quả</th></tr></thead><tbody><tr><td>06/2025</td><td>Nguyễn Văn A</td><td>Sản lượng Giặt thô</td><td class="text-end">10,000 sp</td><td class="text-end">10,500 sp</td><td class="text-center"><span class="badge bg-success">Vượt</span></td></tr><tr><td>06/2025</td><td>Nguyễn Văn A</td><td>Tỷ lệ hàng lỗi</td><td class="text-end">< 1%</td><td class="text-end">0.8%</td><td class="text-center"><span class="badge bg-success">Đạt</span></td></tr><tr><td>06/2025</td><td>Trần Thị B</td><td>Sản lượng Ủi</td><td class="text-end">12,000 sp</td><td class="text-end">11,500 sp</td><td class="text-center"><span class="badge bg-danger">Không đạt</span></td></tr><tr><td>06/2025</td><td>Trần Thị B</td><td>Tỷ lệ hàng lỗi</td><td class="text-end">< 1.5%</td><td class="text-end">1.6%</td><td class="text-center"><span class="badge bg-danger">Không đạt</span></td></tr></tbody></table></div></div></div>`,
        workflows: `<div class="d-flex justify-content-between align-items-center mb-4"><h3>Sơ đồ Quy trình & Trạng thái</h3><button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#workflow-modal"><i class="fas fa-plus me-2"></i>Thêm</button></div><div class="row"><div class="col-lg-6 mb-4"><div class="card h-100 shadow-sm"><div class="card-header d-flex justify-content-between align-items-center"><h6 class="mb-0"><i class="fas fa-file-invoice-dollar me-2"></i>Quy trình Đơn hàng</h6><button class="btn btn-sm btn-outline-secondary border-0" data-bs-toggle="modal" data-bs-target="#workflow-modal"><i class="fas fa-edit"></i></button></div><div class="card-body"><ul class="list-group list-group-flush"><li class="list-group-item"><strong>Phụ trách:</strong> Phòng Kinh Doanh</li><li class="list-group-item"><strong>Lead Time:</strong> 1-2 ngày</li><li class="list-group-item"><strong>Mô tả:</strong> Tiếp nhận và xử lý đơn hàng từ khách.</li></ul><div class="mt-3"><strong>Các trạng thái:</strong><div class="d-flex flex-wrap gap-2 mt-2"><span class="badge bg-primary">Mới nhận</span><span class="badge bg-warning text-dark">Đang sản xuất</span><span class="badge bg-success">Hoàn thành</span><span class="badge bg-info">Đã giao</span><span class="badge bg-danger">Đã hủy</span></div></div></div></div></div><div class="col-lg-6 mb-4"><div class="card h-100 shadow-sm"><div class="card-header d-flex justify-content-between align-items-center"><h6 class="mb-0"><i class="fas fa-industry me-2"></i>Quy trình Sản xuất</h6><button class="btn btn-sm btn-outline-secondary border-0" data-bs-toggle="modal" data-bs-target="#workflow-modal"><i class="fas fa-edit"></i></button></div><div class="card-body"><ul class="list-group list-group-flush"><li class="list-group-item"><strong>Phụ trách:</strong> Quản đốc Xưởng</li><li class="list-group-item"><strong>Lead Time:</strong> 5-10 ngày</li><li class="list-group-item"><strong>Mô tả:</strong> Các công đoạn thực hiện gia công sản phẩm.</li></ul><div class="mt-3"><strong>Các trạng thái:</strong><div class="d-flex flex-wrap gap-2 mt-2"><span class="badge bg-secondary">Mới nhận</span><span class="badge bg-primary">Giặt/Nhuộm</span><span class="badge bg-info">Wash/Ủi</span><span class="badge bg-success">Hoàn thành</span></div></div></div></div></div></div>`,
        'user-guide': `<div class="d-flex justify-content-between align-items-center mb-4"><h3>Hướng dẫn sử dụng</h3><button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#guide-modal"><i class="fas fa-plus me-2"></i>Thêm</button></div><div class="accordion" id="userGuideAccordion"><div class="accordion-item"><h2 class="accordion-header d-flex align-items-center"><button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#guide-1"><i class="fas fa-file-invoice-dollar fa-fw me-3"></i>Quản lý Đơn hàng</button><button class="btn btn-sm btn-outline-secondary border-0 me-2" data-bs-toggle="modal" data-bs-target="#guide-modal"><i class="fas fa-edit"></i></button></h2><div id="guide-1" class="accordion-collapse collapse" data-bs-parent="#userGuideAccordion"><div class="accordion-body"><p>Module này cho phép quản lý toàn bộ vòng đời của một đơn hàng.</p><ol><li>Nhấn nút <strong>"Tạo Đơn Hàng Mới"</strong> để mở form nhập liệu.</li><li>Điền thông tin khách hàng, ngày tháng và thêm các sản phẩm vào đơn.</li><li>Sử dụng nút <i class="fas fa-sync-alt"></i> trong cột "Hành động" để cập nhật trạng thái đơn hàng.</li></ol><a href="#" class="btn btn-primary btn-sm mt-3 nav-link" data-view="orders"><i class="fas fa-arrow-right me-2"></i>Đi tới Module Đơn hàng</a></div></div></div><div class="accordion-item"><h2 class="accordion-header d-flex align-items-center"><button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#guide-2"><i class="fas fa-industry fa-fw me-3"></i>Quản lý Sản xuất</button><button class="btn btn-sm btn-outline-secondary border-0 me-2" data-bs-toggle="modal" data-bs-target="#guide-modal"><i class="fas fa-edit"></i></button></h2><div id="guide-2" class="accordion-collapse collapse" data-bs-parent="#userGuideAccordion"><div class="accordion-body"><p>Theo dõi tiến độ sản xuất của các lô hàng theo từng công đoạn.</p><ol><li>Tại tab <strong>"Kế hoạch Sản xuất"</strong>, xem các lô hàng dưới dạng bảng Kanban.</li><li>Nhấn nút <strong>"Ghi nhật ký"</strong> trên một lô hàng để cập nhật số lượng.</li><li>Chuyển qua tab <strong>"Nhật ký Sản xuất"</strong> để xem lịch sử chi tiết.</li></ol><a href="#" class="btn btn-primary btn-sm mt-3 nav-link" data-view="production"><i class="fas fa-arrow-right me-2"></i>Đi tới Module Sản xuất</a></div></div></div></div>`
    };

    function initializeTooltips() {
        // Hủy các tooltip cũ để tránh lỗi
        bsTooltipList.forEach(t => t.dispose());
        bsTooltipList = [...document.querySelectorAll('[data-bs-toggle="tooltip"]')].map(el => new bootstrap.Tooltip(el));
    }

    function renderView(viewId) {
        globalSearchInput.placeholder = searchPlaceholders[viewId] || 'Tìm kiếm...';
        mainContentArea.innerHTML = viewTemplates[viewId] || `<h3 class="p-5">Chức năng đang được phát triển...</h3>`;
        mainContentArea.classList.add('active');
        // Xóa class active sau khi animation hoàn thành để có thể chạy lại
        setTimeout(() => mainContentArea.classList.remove('active'), 500);

        if (viewId === 'dashboard') {
            // --- START: SỬA LỖI ---
            // Hủy các instance biểu đồ cũ trước khi tạo mới để tránh memory leak
            if (planCompletionChartInstance) { planCompletionChartInstance.destroy(); }
            if (weeklyProductionChartInstance) { weeklyProductionChartInstance.destroy(); }
            if (incidentByCategoryChartInstance) { incidentByCategoryChartInstance.destroy(); }
            // --- END: SỬA LỖI ---
            
            // Render Radial Bar Chart (ApexCharts)
            const planChartEl = document.getElementById('planCompletionChart');
            if (planChartEl) {
                planCompletionChartInstance = new ApexCharts(planChartEl, {
                    series: [92],
                    chart: { height: 220, type: 'radialBar' },
                    plotOptions: { radialBar: { hollow: { size: '65%' } } },
                    labels: ['Hoàn thành']
                });
                planCompletionChartInstance.render();
            }

            // Render Weekly Production Chart (Chart.js)
            const weeklyChartEl = document.getElementById('weeklyProductionChart');
            if (weeklyChartEl) {
                weeklyProductionChartInstance = new Chart(weeklyChartEl, {
                    type: 'bar',
                    data: {
                        labels: ['Tuần 1', 'Tuần 2', 'Tuần 3', 'Tuần 4'],
                        datasets: [{ label: 'Sản lượng', data: [4500, 5200, 4800, 5500], backgroundColor: 'rgba(25, 135, 84, 0.7)' }]
                    },
                    options: {
                        responsive: true,
                        // --- START: SỬA LỖI ---
                        // Xóa `maintainAspectRatio: false` để biểu đồ tự co giãn cân đối
                        // maintainAspectRatio: false 
                        // --- END: SỬA LỖI ---
                    }
                });
            }
            
            // Render Incident Chart (Chart.js)
            const incidentChartEl = document.getElementById('incidentByCategoryChart');
            if (incidentChartEl) {
                incidentByCategoryChartInstance = new Chart(incidentChartEl, {
                    type: 'bar',
                    data: {
                        labels: ['Giặt', 'Nhuộm', 'Ủi', 'Khác'],
                        datasets: [{ label: 'Số sự cố', data: [7, 5, 3, 2], backgroundColor: 'rgba(255, 193, 7, 0.7)' }]
                    },
                    options: {
                        responsive: true,
                        indexAxis: 'y',
                        plugins: { legend: { display: false } }
                        // --- START: SỬA LỖI ---
                        // Xóa `maintainAspectRatio: false` để biểu đồ tự co giãn cân đối
                        // maintainAspectRatio: false,
                        // --- END: SỬA LỖI ---
                    }
                });
            }
        }
        initializeTooltips();
    }
    
    function setActiveLink(targetLink) {
        document.querySelectorAll('#sidebar .components li').forEach(li => li.classList.remove('active'));
        if (targetLink) {
            const parentLi = targetLink.closest('li');
            if (parentLi) {
                parentLi.classList.add('active');
                const submenu = targetLink.closest('.collapse');
                if (submenu) {
                    const trigger = document.querySelector(`a[href="#${submenu.id}"]`);
                    if (trigger) {
                        trigger.closest('li').classList.add('active');
                        if (!submenu.classList.contains('show')) {
                            new bootstrap.Collapse(submenu).show();
                        }
                    }
                }
            }
        }
    }

    function toggleMobileSidebar() {
        sidebar.classList.toggle('show');
        sidebarOverlay.classList.toggle('active');
    }

    desktopSidebarToggleBtn.addEventListener('click', () => { document.body.classList.toggle('sidebar-collapsed'); });
    mobileSidebarToggleBtn.addEventListener('click', toggleMobileSidebar);
    sidebarOverlay.addEventListener('click', toggleMobileSidebar);

    document.body.addEventListener('click', (e) => {
        const link = e.target.closest('.nav-link, .nav-link-profile');
        if (link && link.dataset.view) {
            e.preventDefault();
            renderView(link.dataset.view);
            setActiveLink(link.closest('#sidebar .nav-link'));
            if (window.innerWidth < 992 && sidebar.classList.contains('show')) {
                toggleMobileSidebar();
            }
        }
    });
    
    // JS for other modals (attendance, finance)
    
    // Event delegation for Workflow Tag Input
    document.body.addEventListener('keydown', (e) => {
        if (e.target.id === 'workflow-tag-input' && e.key === 'Enter') {
            e.preventDefault();
            const input = e.target;
            const container = document.getElementById('workflow-tags-container');
            const tagText = input.value.trim();
            if (tagText && container) {
                const tag = document.createElement('span');
                tag.className = 'badge bg-secondary d-flex align-items-center';
                tag.textContent = tagText;
                const closeBtn = document.createElement('button');
                closeBtn.type = 'button';
                closeBtn.className = 'btn-close btn-close-white ms-2';
                closeBtn.style.transform = 'scale(0.7)';
                closeBtn.onclick = () => tag.remove();
                tag.appendChild(closeBtn);
                container.appendChild(tag);
                input.value = '';
            }
        }
    });

    // Initial load
    renderView('dashboard');
    setActiveLink(document.querySelector(`#sidebar .nav-link[data-view="dashboard"]`));
});
</script>
</body>
</html>
